<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OptimXmlPreview - Navigation des emails</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.snow.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.bubble.css" />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          'Inter',
          -apple-system,
          BlinkMacSystemFont,
          'Segoe UI',
          sans-serif;
        background-color: #f8fafc;
        color: #1f2937;
        overflow: hidden;
      }

      .app-container {
        height: 100vh;
        display: flex;
        flex-direction: column;
      }

      /* Header */
      .header-bar {
        background: linear-gradient(135deg, #141325 0%, #1e1b4b 100%);
        color: white;
        padding: 1rem 1.5rem;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        z-index: 100;
      }

      .header-content {
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .header-icon {
        font-size: 1.5rem;
        color: #d60405;
      }

      .header-bar h1 {
        font-size: 1.5rem;
        font-weight: 600;
        flex: 1;
      }

      .convert-button {
        background: linear-gradient(135deg, #059669 0%, #10b981 100%);
        color: white;
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.2s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .convert-button:hover {
        background: linear-gradient(135deg, #047857 0%, #059669 100%);
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
      }

      .convert-button:active {
        transform: translateY(0);
      }

      .convert-button:disabled {
        opacity: 0.7;
        cursor: not-allowed;
        transform: none !important;
      }

      .convert-button i {
        font-size: 1rem;
      }

      .email-count {
        background: rgba(59, 130, 246, 0.2);
        padding: 0.25rem 0.75rem;
        border-radius: 1rem;
        font-size: 0.875rem;
        border: 1px solid rgba(59, 130, 246, 0.3);
      }

      /* Main Content */
      .main-content {
        display: flex;
        flex: 1;
        overflow: hidden;
      }

      /* Sidebar */
      .sidebar {
        width: 38rem; /* 608px */
        resize: horizontal;
        overflow: auto;
        background: #141325;
        color: white;
        border-right: 1px solid #1e1b4b;
        display: flex;
        flex-direction: column;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.15);
      }

      .sidebar-header {
        padding: 1.5rem;
        border-bottom: 1px solid #1e1b4b;
        background: #0f0f23;
      }

      .sidebar-header h2 {
        font-size: 1.125rem;
        font-weight: 600;
        color: #e5e7eb;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .search-box {
        position: relative;
      }

      .search-box i {
        position: absolute;
        left: 0.75rem;
        top: 50%;
        transform: translateY(-50%);
        color: #6b7280;
        font-size: 0.875rem;
      }

      .search-box input {
        width: 100%;
        padding: 0.5rem 0.75rem 0.5rem 2.25rem;
        border: 1px solid #374151;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        background: #1f2937;
        color: white;
        transition: border-color 0.2s;
      }

      .search-box input:focus {
        outline: none;
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      .search-box input::placeholder {
        color: #9ca3af;
      }

      /* Email List */
      .email-list {
        flex: 1;
        overflow-y: auto;
        padding: 0.5rem;
      }

      .email-section-header {
        padding: 1rem 1rem 0.5rem 1rem;
        margin-top: 1rem;
        border-top: 1px solid #374151;
      }

      .email-section-header:first-child {
        margin-top: 0;
        border-top: none;
      }

      .email-section-header h3 {
        margin: 0;
        font-size: 0.875rem;
        font-weight: 600;
        color: #e5e7eb;
        text-transform: uppercase;
        letter-spacing: 0.025em;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .email-section-header h3 i {
        color: #10b981;
        font-size: 0.75rem;
      }

      .email-section-header h3 .fa-archive {
        color: #6b7280;
      }

      .email-item {
        display: flex;
        align-items: center;
        padding: 1rem;
        margin-bottom: 0.5rem;
        border-radius: 0.75rem;
        cursor: pointer;
        transition: all 0.2s ease;
        border: 2px solid transparent;
        color: #d1d5db;
      }

      .email-item:hover {
        background: #1f2937;
        border-color: #374151;
      }

      .email-item.active {
        background: #1e3a8a;
        border-color: #3b82f6;
        color: white;
      }

      .email-item.recent {
        background: rgba(0, 105, 72, 0.1);
        border-color: rgba(0, 105, 72, 0.3);
      }

      .email-item.recent:hover {
        background: rgba(0, 105, 72, 0.2);
        border-color: #006948;
      }

      .email-item.recent.active {
        background: #006948;
        border-color: #059669;
      }

      .email-icon {
        margin-right: 0.75rem;
        color: #9ca3af;
        font-size: 1.25rem;
      }

      .email-item.active .email-icon {
        color: #dbeafe;
      }

      .email-item.recent .email-icon {
        color: #10b981;
      }

      .email-item.recent.active .email-icon {
        color: white;
      }

      .email-info {
        flex: 1;
        min-width: 0;
      }

      .email-title {
        font-weight: 500;
        font-size: 0.875rem;
        color: inherit;
        margin-bottom: 0.25rem;
        white-space: normal;
        overflow: visible;
        text-overflow: initial;
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .recent-star {
        color: #fbbf24;
        font-size: 0.75rem;
        flex-shrink: 0;
      }

      .email-meta {
        display: flex;
        gap: 0.75rem;
        font-size: 0.75rem;
        color: #9ca3af;
      }

      .email-item.active .email-meta {
        color: #cbd5e1;
      }

      .email-actions {
        opacity: 0;
        transition: opacity 0.2s;
        color: #9ca3af;
        font-size: 0.875rem;
      }

      .email-item:hover .email-actions {
        opacity: 1;
      }

      .email-actions i:hover {
        color: #3b82f6;
      }

      .email-item.recent .email-actions i:hover {
        color: #22c55e;
      }

      /* Content Area */
      .content-area {
        flex: 1;
        display: flex;
        flex-direction: column;
        background: white;
        position: relative;
      }

      .welcome-screen {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #f8fafc 0%, #e5e7eb 100%);
      }

      .welcome-content {
        text-align: center;
        max-width: 500px;
        padding: 2rem;
      }

      .welcome-icon {
        font-size: 4rem;
        color: #6b7280;
        margin-bottom: 1.5rem;
      }

      .welcome-content h2 {
        font-size: 1.875rem;
        font-weight: 600;
        color: #1f2937;
        margin-bottom: 1rem;
      }

      .welcome-content p {
        font-size: 1.125rem;
        color: #6b7280;
        margin-bottom: 2rem;
      }

      .stats {
        display: flex;
        gap: 2rem;
        justify-content: center;
        flex-wrap: wrap;
      }

      .stat-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
        color: #374151;
      }

      .stat-item i {
        color: #3b82f6;
      }

      #contentFrame {
        width: 100%;
        height: 100%;
        border: none;
        background: white;
      }

      /* Notifications */
      .notification {
        position: fixed;
        top: 5rem;
        right: 1.5rem;
        background: white;
        color: #374151;
        padding: 1rem 1.5rem;
        border-radius: 0.5rem;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
        border-left: 4px solid #3b82f6;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        min-width: 300px;
        transform: translateX(100%);
        opacity: 0;
        transition: all 0.3s ease;
        z-index: 1000;
        font-size: 0.875rem;
        font-weight: 500;
      }

      .notification.show {
        transform: translateX(0);
        opacity: 1;
      }

      .notification-success {
        border-left-color: #10b981;
      }

      .notification-success i {
        color: #10b981;
      }

      .notification-error {
        border-left-color: #ef4444;
      }

      .notification-error i {
        color: #ef4444;
      }

      .notification i {
        font-size: 1.25rem;
        flex-shrink: 0;
      }

      .email-select {
        margin-right: 0.75rem;
        cursor: pointer;
      }
      .email-actions i {
        cursor: pointer;
      }
      .email-actions i + i {
        margin-left: 0.5rem;
      }
      .send-selected-button {
        background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
        color: white;
        border: none;
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.2s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .send-selected-button:hover {
        background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
        transform: translateY(-1px);
      }
      .send-selected-button:disabled {
        opacity: 0.7;
        cursor: not-allowed;
        transform: none !important;
      }

      /* Ajout styles Drag&Drop */
      .sidebar.drop-target {
        outline: 2px dashed #3b82f6;
        position: relative;
      }
      .sidebar.drop-target::after {
        content: 'Déposez vos fichiers XML ici';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #3b82f6;
        font-size: 0.875rem;
        pointer-events: none;
      }

      /* Settings Button */
      .settings-button {
        background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%);
        color: #fff;
        border: none;
        padding: 0.75rem;
        border-radius: 0.5rem;
        cursor: pointer;
        transition: all 0.2s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .settings-button:hover {
        background: linear-gradient(135deg, #2563eb 0%, #3b82f6 100%);
        transform: translateY(-1px);
      }

      /* Modal */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 200;
      }

      .modal {
        background: #fff;
        border-radius: 0.5rem;
        padding: 1.5rem;
        width: 800px; /* doubled */
        max-width: 95%;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .modal h3 {
        margin: 0;
        font-size: 1.125rem;
      }

      .modal textarea {
        width: 100%;
        height: 80px; /* increased */
        padding: 0.5rem;
        border: 1px solid #d1d5db;
        border-radius: 0.375rem;
        resize: vertical;
        font-family: inherit;
        font-size: 0.875rem;
      }

      .modal .token-list {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
      }

      .modal .token {
        background: #e5e7eb;
        color: #111827;
        padding: 0.25rem 0.5rem;
        border-radius: 0.375rem;
        cursor: pointer;
        font-size: 0.75rem;
      }

      .modal .actions {
        display: flex;
        justify-content: flex-end;
        gap: 0.5rem;
      }

      .modal button {
        padding: 0.5rem 1rem;
        border: none;
        border-radius: 0.375rem;
        font-size: 0.875rem;
        cursor: pointer;
      }

      .modal .save-btn {
        background: #059669;
        color: #fff;
      }

      .modal .close-btn {
        background: #6b7280;
        color: #fff;
      }

      /* Resizer */
      .resizer {
        width: 5px;
        background: #1e1b4b;
        cursor: ew-resize;
      }
      .resizer:hover {
        background: #374151;
      }
    </style>
  </head>
  <body>
    <div class="app-container">
      <!-- Header -->
      <div class="header-bar">
        <div class="header-content">
          <i class="fas fa-envelope-open-text header-icon"></i>
          <h1>OptimXmlPreview</h1>
          <button id="convertButton" class="convert-button">
            <i class="fas fa-sync-alt"></i>
            Convertir nouveaux emails
          </button>
          <button id="openSettings" class="settings-button" title="Paramètres email">
            <i class="fas fa-cog"></i>
          </button>
          <button class="send-selected-button" id="sendSelectedButton" disabled>
            <i class="fas fa-paper-plane"></i>
            Envoyer sélection
          </button>
          <span class="email-count">1 nouveaux / 69 emails</span>
        </div>
      </div>

      <div class="main-content">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
          <div class="sidebar-header">
            <h2><i class="fas fa-list"></i> Emails convertis</h2>
            <div class="search-box">
              <i class="fas fa-search"></i>
              <input type="text" id="searchInput" placeholder="Rechercher..." />
            </div>
          </div>
          <div class="email-list" id="emailList">
            <div class="email-section-header">
              <h3><i class="fas fa-plus-circle"></i> Nouveaux emails (1)</h3>
            </div>

            <div
              class="email-item recent"
              data-file="Output/20250321 14_26_00 Mise Ã  disposition [20 03766] 21 03 2025  EPI  Echanges entre parties pour information.html"
              data-pdf="pdf/20250321 14_26_00 Mise Ã  disposition [20 03766] 21 03 2025  EPI  Echanges entre parties pour information.pdf"
              data-index="0"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">
                  20250321 14_26_00 Mise Ã disposition [20 03766] 2...
                  <i class="fas fa-star recent-star" title="Nouveau fichier"></i>
                </div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div class="email-section-header">
              <h3><i class="fas fa-archive"></i> Emails précédents (68)</h3>
            </div>

            <div
              class="email-item"
              data-file="Output/20250321 09_57_00 Incident [15 01319] 24 03 2025  CRPV  Conclusions ci-jointes par RPVA.html"
              data-pdf="pdf/20250321 09_57_00 Incident [15 01319] 24 03 2025  CRPV  Conclusions ci-jointes par RPVA.pdf"
              data-index="1"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250321 09_57_00 Incident [15 01319] 24 03 2025 ...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 15_22_00 Plaidoirie [25 00326] 26 03 2025  CRPV  Conclusions ci-jointes par RPVA.html"
              data-pdf="pdf/20250325 15_22_00 Plaidoirie [25 00326] 26 03 2025  CRPV  Conclusions ci-jointes par RPVA.pdf"
              data-index="2"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 15_22_00 Plaidoirie [25 00326] 26 03 2025...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 15_12_00 Re    IREF  Projet d assignation de Maître KERKERIAN n° CNBF   064230.html"
              data-pdf="pdf/20250325 15_12_00 Re    IREF  Projet d assignation de Maître KERKERIAN n° CNBF   064230.pdf"
              data-index="3"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 15_12_00 Re IREF Projet d assignation...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 15_28_00 Accusé de réception   M E E  [23 08289] 27 02 2025  CRPV  Conclusions ci-jointes par RPVA.html"
              data-pdf="pdf/20250325 15_28_00 Accusé de réception   M E E  [23 08289] 27 02 2025  CRPV  Conclusions ci-jointes par RPVA.pdf"
              data-index="4"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 15_28_00 Accusé de réception M E E [23...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 16_09_00 M E E  [22 02789] 26 03 2025  CMAG  Courrier au magistrat.html"
              data-pdf="pdf/20250325 16_09_00 M E E  [22 02789] 26 03 2025  CMAG  Courrier au magistrat.pdf"
              data-index="5"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 16_09_00 M E E [22 02789] 26 03 2025 CM...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 14_54_00 Mise à disposition [16 14635] 14 03 2025 notification de décision à avocat.html"
              data-pdf="pdf/20250325 14_54_00 Mise à disposition [16 14635] 14 03 2025 notification de décision à avocat.pdf"
              data-index="6"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 14_54_00 Mise à disposition [16 14635] 14...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 15_03_00 M E E  [22 00862] 22 04 2025  CLI  Conclusions 1.html"
              data-pdf="pdf/20250325 15_03_00 M E E  [22 00862] 22 04 2025  CLI  Conclusions 1.pdf"
              data-index="7"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 15_03_00 M E E [22 00862] 22 04 2025 CL...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 14_43_00 Plaidoirie [24 08241] 26 03 2025  CLI  Conclusions 1.html"
              data-pdf="pdf/20250325 14_43_00 Plaidoirie [24 08241] 26 03 2025  CLI  Conclusions 1.pdf"
              data-index="8"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 14_43_00 Plaidoirie [24 08241] 26 03 2025...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 14_38_00 Accusé de réception   Prononcé [23 06718] 25 03 2025 notification de décision à avocat.html"
              data-pdf="pdf/20250325 14_38_00 Accusé de réception   Prononcé [23 06718] 25 03 2025 notification de décision à avocat.pdf"
              data-index="9"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 14_38_00 Accusé de réception Prononcé [...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 14_57_00 Re    IREF  Projet d assignation de Maître KERKERIAN n° CNBF   064230.html"
              data-pdf="pdf/20250325 14_57_00 Re    IREF  Projet d assignation de Maître KERKERIAN n° CNBF   064230.pdf"
              data-index="10"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 14_57_00 Re IREF Projet d assignation...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 14_16_00 Incident [24 05843] 02 04 2025  CINC  Conclusions d incident.html"
              data-pdf="pdf/20250325 14_16_00 Incident [24 05843] 02 04 2025  CINC  Conclusions d incident.pdf"
              data-index="11"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 14_16_00 Incident [24 05843] 02 04 2025 ...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 14_09_00  CDEF  Constitution en défense de Maître PETIT-SCHMITTER n° CNBF   028801.html"
              data-pdf="pdf/20250325 14_09_00  CDEF  Constitution en défense de Maître PETIT-SCHMITTER n° CNBF   028801.pdf"
              data-index="12"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 14_09_00 CDEF Constitution en défense d...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 14_27_00 Re    IREF  Projet d assignation de Maître KERKERIAN n° CNBF   064230.html"
              data-pdf="pdf/20250325 14_27_00 Re    IREF  Projet d assignation de Maître KERKERIAN n° CNBF   064230.pdf"
              data-index="13"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 14_27_00 Re IREF Projet d assignation...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 14_27_00 Re    IREF  Projet d assignation de Maître KERKERIAN n° CNBF   064230_1.html"
              data-pdf="pdf/20250325 14_27_00 Re    IREF  Projet d assignation de Maître KERKERIAN n° CNBF   064230_1.pdf"
              data-index="14"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 14_27_00 Re IREF Projet d assignation...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 14_19_00 M E E  [22 02789] 26 03 2025  DRV  Demande de renvoi.html"
              data-pdf="pdf/20250325 14_19_00 M E E  [22 02789] 26 03 2025  DRV  Demande de renvoi.pdf"
              data-index="15"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 14_19_00 M E E [22 02789] 26 03 2025 DR...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 12_12_00  Demandeur   Domenico MALARA.html"
              data-pdf="pdf/20250325 12_12_00  Demandeur   Domenico MALARA.pdf"
              data-index="16"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 12_12_00 Demandeur Domenico MALARA</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 12_13_00 Plaidoirie [25 01171] 14 05 2025  SCOM  Sommation de communiquer les pièces.html"
              data-pdf="pdf/20250325 12_13_00 Plaidoirie [25 01171] 14 05 2025  SCOM  Sommation de communiquer les pièces.pdf"
              data-index="17"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 12_13_00 Plaidoirie [25 01171] 14 05 2025...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 11_55_00 Accusé de réception   Plaidoirie [25 00096] 25 03 2025 communications de pièces.html"
              data-pdf="pdf/20250325 11_55_00 Accusé de réception   Plaidoirie [25 00096] 25 03 2025 communications de pièces.pdf"
              data-index="18"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 11_55_00 Accusé de réception Plaidoirie...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 11_57_00 Re    IREF  Projet d assignation de Maître KERKERIAN n° CNBF   064230.html"
              data-pdf="pdf/20250325 11_57_00 Re    IREF  Projet d assignation de Maître KERKERIAN n° CNBF   064230.pdf"
              data-index="19"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 11_57_00 Re IREF Projet d assignation...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 12_12_00 Re   Plaidoirie [25 00096] 26 03 2025  CBCP  Conclusions + BCP ci-jointspar RPVA.html"
              data-pdf="pdf/20250325 12_12_00 Re   Plaidoirie [25 00096] 26 03 2025  CBCP  Conclusions + BCP ci-jointspar RPVA.pdf"
              data-index="20"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 12_12_00 Re Plaidoirie [25 00096] 26 03...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 10_45_00 Autre [24 01773] 25 03 2025 notification de décision à avocat.html"
              data-pdf="pdf/20250325 10_45_00 Autre [24 01773] 25 03 2025 notification de décision à avocat.pdf"
              data-index="21"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 10_45_00 Autre [24 01773] 25 03 2025 noti...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 11_09_00 Mise en état [22 11203] 25 03 2025  SCOM  Transmission sommation de communiquer.html"
              data-pdf="pdf/20250325 11_09_00 Mise en état [22 11203] 25 03 2025  SCOM  Transmission sommation de communiquer.pdf"
              data-index="22"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 11_09_00 Mise en état [22 11203] 25 03 20...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 11_08_00 Mise en état [22 10538] 25 03 2025  SCOM  Transmission sommation de communiquer.html"
              data-pdf="pdf/20250325 11_08_00 Mise en état [22 10538] 25 03 2025  SCOM  Transmission sommation de communiquer.pdf"
              data-index="23"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 11_08_00 Mise en état [22 10538] 25 03 20...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 10_57_00 Re   Plaidoirie [25 00326] 26 03 2025  CBCP  Conclusions + BCP ci-jointspar RPVA.html"
              data-pdf="pdf/20250325 10_57_00 Re   Plaidoirie [25 00326] 26 03 2025  CBCP  Conclusions + BCP ci-jointspar RPVA.pdf"
              data-index="24"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 10_57_00 Re Plaidoirie [25 00326] 26 03...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 10_38_00 Accusé de réception   Plaidoirie [25 00326] 25 03 2025 communications de pièces.html"
              data-pdf="pdf/20250325 10_38_00 Accusé de réception   Plaidoirie [25 00326] 25 03 2025 communications de pièces.pdf"
              data-index="25"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 10_38_00 Accusé de réception Plaidoirie...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 10_12_00 Plaidoirie [19 01665] 04 04 2025  CBCP  Conclusions + BCP ci-joints par RPVA.html"
              data-pdf="pdf/20250325 10_12_00 Plaidoirie [19 01665] 04 04 2025  CBCP  Conclusions + BCP ci-joints par RPVA.pdf"
              data-index="26"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 10_12_00 Plaidoirie [19 01665] 04 04 2025...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 10_12_00 Plaidoirie [19 01665] 25 03 2025 notification de contestation du projet de répartition.html"
              data-pdf="pdf/20250325 10_12_00 Plaidoirie [19 01665] 25 03 2025 notification de contestation du projet de répartition.pdf"
              data-index="27"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 10_12_00 Plaidoirie [19 01665] 25 03 2025...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 10_32_00 Plaidoirie [25 00096] 26 03 2025 communications de pièces.html"
              data-pdf="pdf/20250325 10_32_00 Plaidoirie [25 00096] 26 03 2025 communications de pièces.pdf"
              data-index="28"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 10_32_00 Plaidoirie [25 00096] 26 03 2025...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 10_10_00 M E E  [20 06082] 19 05 2025  INCI  Demande de fixation incident de mise en état.html"
              data-pdf="pdf/20250325 10_10_00 M E E  [20 06082] 19 05 2025  INCI  Demande de fixation incident de mise en état.pdf"
              data-index="29"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 10_10_00 M E E [20 06082] 19 05 2025 IN...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 09_46_00 Accusé de réception   Prononcé [24 03216] 25 03 2025 notification de décision à avocat.html"
              data-pdf="pdf/20250325 09_46_00 Accusé de réception   Prononcé [24 03216] 25 03 2025 notification de décision à avocat.pdf"
              data-index="30"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 09_46_00 Accusé de réception Prononcé [...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 14_02_00 Mise à disposition [16 14635] 24 03 2025 notification de décision à avocat.html"
              data-pdf="pdf/20250324 14_02_00 Mise à disposition [16 14635] 24 03 2025 notification de décision à avocat.pdf"
              data-index="31"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 14_02_00 Mise à disposition [16 14635] 24...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 14_51_00  CDEF  Constitution en défense de Maître DREVET n° CNBF   007350.html"
              data-pdf="pdf/20250324 14_51_00  CDEF  Constitution en défense de Maître DREVET n° CNBF   007350.pdf"
              data-index="32"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 14_51_00 CDEF Constitution en défense d...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250325 09_32_00 M E E  [24 04866] 19 05 2025  RME  Demande de renvoi à la mise en état.html"
              data-pdf="pdf/20250325 09_32_00 M E E  [24 04866] 19 05 2025  RME  Demande de renvoi à la mise en état.pdf"
              data-index="33"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250325 09_32_00 M E E [24 04866] 19 05 2025 RM...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 17_10_00 M E E  [24 00255] 01-04-2025  CONC  Conclusions au Fond.html"
              data-pdf="pdf/20250324 17_10_00 M E E  [24 00255] 01-04-2025  CONC  Conclusions au Fond.pdf"
              data-index="34"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 17_10_00 M E E [24 00255] 01-04-2025 CO...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 15_57_00  incident mise en état  - Chambre 1 -  [N° RG 23 08187 - N° Portalis DB3D-W-B7H-KBHC].html"
              data-pdf="pdf/20250324 15_57_00  incident mise en état  - Chambre 1 -  [N° RG 23 08187 - N° Portalis DB3D-W-B7H-KBHC].pdf"
              data-index="35"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 15_57_00 incident mise en état - Chambr...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 14_00_00 M E E  [23 01235] 06 05 2025  CRPV  Conclusions ci-jointes par RPVA.html"
              data-pdf="pdf/20250324 14_00_00 M E E  [23 01235] 06 05 2025  CRPV  Conclusions ci-jointes par RPVA.pdf"
              data-index="36"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 14_00_00 M E E [23 01235] 06 05 2025 CR...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 13_58_00 M E E  [23 01162] 06 05 2025  CRPV  Conclusions ci-jointes par RPVA.html"
              data-pdf="pdf/20250324 13_58_00 M E E  [23 01162] 06 05 2025  CRPV  Conclusions ci-jointes par RPVA.pdf"
              data-index="37"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 13_58_00 M E E [23 01162] 06 05 2025 CR...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 12_31_00 Accusé de réception   Prononcé [21 07549] 24 03 2025 notification de décision à avocat.html"
              data-pdf="pdf/20250324 12_31_00 Accusé de réception   Prononcé [21 07549] 24 03 2025 notification de décision à avocat.pdf"
              data-index="38"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 12_31_00 Accusé de réception Prononcé [...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 12_43_00 Accusé de réception   Prononcé [17 08324] 24 03 2025 notification de décision à avocat.html"
              data-pdf="pdf/20250324 12_43_00 Accusé de réception   Prononcé [17 08324] 24 03 2025 notification de décision à avocat.pdf"
              data-index="39"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 12_43_00 Accusé de réception Prononcé [...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 13_42_00 Re   Plaidoirie [24 06091] 26 03 2025  CBCP  Conclusions + BCP ci-jointspar RPVA.html"
              data-pdf="pdf/20250324 13_42_00 Re   Plaidoirie [24 06091] 26 03 2025  CBCP  Conclusions + BCP ci-jointspar RPVA.pdf"
              data-index="40"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 13_42_00 Re Plaidoirie [24 06091] 26 03...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 09_16_00 M E E  [25 01673] 24 03 2025  CONS  Constitution par RPVA.html"
              data-pdf="pdf/20250324 09_16_00 M E E  [25 01673] 24 03 2025  CONS  Constitution par RPVA.pdf"
              data-index="41"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 09_16_00 M E E [25 01673] 24 03 2025 CO...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 09_19_00 Incident [23 08305] 28 04 2025  CRPV  Conclusions ci-jointes par RPVA.html"
              data-pdf="pdf/20250324 09_19_00 Incident [23 08305] 28 04 2025  CRPV  Conclusions ci-jointes par RPVA.pdf"
              data-index="42"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 09_19_00 Incident [23 08305] 28 04 2025 ...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 11_30_00 Dépôt de dossier [24 06313] 24 03 2025  CIG  Courriel d information au greffe.html"
              data-pdf="pdf/20250324 11_30_00 Dépôt de dossier [24 06313] 24 03 2025  CIG  Courriel d information au greffe.pdf"
              data-index="43"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 11_30_00 Dépôt de dossier [24 06313] 24 0...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 12_19_00 Accusé de réception   Plaidoirie [24 06091] 24 03 2025 communications de pièces.html"
              data-pdf="pdf/20250324 12_19_00 Accusé de réception   Plaidoirie [24 06091] 24 03 2025 communications de pièces.pdf"
              data-index="44"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 12_19_00 Accusé de réception Plaidoirie...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 09_43_00 M E E  [24 00370] 27 03 2025  RME  Demande de renvoi à la mise en état.html"
              data-pdf="pdf/20250324 09_43_00 M E E  [24 00370] 27 03 2025  RME  Demande de renvoi à la mise en état.pdf"
              data-index="45"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 09_43_00 M E E [24 00370] 27 03 2025 RM...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250322 14_56_00 Plaidoirie [25 01616] 26 03 2025 communications de pièces.html"
              data-pdf="pdf/20250322 14_56_00 Plaidoirie [25 01616] 26 03 2025 communications de pièces.pdf"
              data-index="46"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250322 14_56_00 Plaidoirie [25 01616] 26 03 2025...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250322 15_04_00 Plaidoirie [25 01616] 26 03 2025 communications de pièces.html"
              data-pdf="pdf/20250322 15_04_00 Plaidoirie [25 01616] 26 03 2025 communications de pièces.pdf"
              data-index="47"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250322 15_04_00 Plaidoirie [25 01616] 26 03 2025...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250323 16_18_00 Incident [23 02846] 24 03 2025  CRPV  Conclusions ci-jointes par RPVA.html"
              data-pdf="pdf/20250323 16_18_00 Incident [23 02846] 24 03 2025  CRPV  Conclusions ci-jointes par RPVA.pdf"
              data-index="48"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250323 16_18_00 Incident [23 02846] 24 03 2025 ...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250324 08_22_00 Orientation [24 09622] 25 03 2025  RME  Demande de renvoi à la mise en état.html"
              data-pdf="pdf/20250324 08_22_00 Orientation [24 09622] 25 03 2025  RME  Demande de renvoi à la mise en état.pdf"
              data-index="49"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250324 08_22_00 Orientation [24 09622] 25 03 202...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250321 22_33_00 Re  Incident [23 02846] 24 03 2025  CRPV  Conclusions ci-jointes par RPVA.html"
              data-pdf="pdf/20250321 22_33_00 Re  Incident [23 02846] 24 03 2025  CRPV  Conclusions ci-jointes par RPVA.pdf"
              data-index="50"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250321 22_33_00 Re Incident [23 02846] 24 03 20...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250321 17_47_00 M E E  [24 00079] 19 02 2025 communications de pièces.html"
              data-pdf="pdf/20250321 17_47_00 M E E  [24 00079] 19 02 2025 communications de pièces.pdf"
              data-index="51"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250321 17_47_00 M E E [24 00079] 19 02 2025 com...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250321 22_30_00 Incident [23 02846] 24 03 2025  CLI  Conclusions 1.html"
              data-pdf="pdf/20250321 22_30_00 Incident [23 02846] 24 03 2025  CLI  Conclusions 1.pdf"
              data-index="52"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250321 22_30_00 Incident [23 02846] 24 03 2025 ...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250321 17_46_00 M E E  [24 00079] 19 02 2025  CBCP  Conclusions + BCP ci-joints par RPVA.html"
              data-pdf="pdf/20250321 17_46_00 M E E  [24 00079] 19 02 2025  CBCP  Conclusions + BCP ci-joints par RPVA.pdf"
              data-index="53"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250321 17_46_00 M E E [24 00079] 19 02 2025 CB...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250321 17_48_00 Incident [23 02846] 24 03 2025  CRPV  Conclusions ci-jointes par RPVA.html"
              data-pdf="pdf/20250321 17_48_00 Incident [23 02846] 24 03 2025  CRPV  Conclusions ci-jointes par RPVA.pdf"
              data-index="54"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250321 17_48_00 Incident [23 02846] 24 03 2025 ...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250321 17_56_00  CDEF  Constitution en défense de Maître LATAPIE n° CNBF   096546.html"
              data-pdf="pdf/20250321 17_56_00  CDEF  Constitution en défense de Maître LATAPIE n° CNBF   096546.pdf"
              data-index="55"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250321 17_56_00 CDEF Constitution en défense d...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250321 17_26_00 Accusé de réception    IREF  Projet d assignation de Maître KERKERIAN n° CNBF   064230.html"
              data-pdf="pdf/20250321 17_26_00 Accusé de réception    IREF  Projet d assignation de Maître KERKERIAN n° CNBF   064230.pdf"
              data-index="56"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250321 17_26_00 Accusé de réception IREF Pro...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250321 17_12_00 Re   Incident [24 00472] 24 03 2025  CBCP  Conclusions + BCP ci-jointspar RPVA.html"
              data-pdf="pdf/20250321 17_12_00 Re   Incident [24 00472] 24 03 2025  CBCP  Conclusions + BCP ci-jointspar RPVA.pdf"
              data-index="57"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250321 17_12_00 Re Incident [24 00472] 24 03 2...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250321 14_26_00 Mise à disposition [20 03766] 21 03 2025  EPI  Echanges entre parties pour information.html"
              data-pdf="pdf/20250321 14_26_00 Mise à disposition [20 03766] 21 03 2025  EPI  Echanges entre parties pour information.pdf"
              data-index="58"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250321 14_26_00 Mise à disposition [20 03766] 21...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/20250321 17_12_00 Re   Incident [23 02846] 24 03 2025  CRPV  Conclusions ci-jointes parRPVA.html"
              data-pdf="pdf/20250321 17_12_00 Re   Incident [23 02846] 24 03 2025  CRPV  Conclusions ci-jointes parRPVA.pdf"
              data-index="59"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">20250321 17_12_00 Re Incident [23 02846] 24 03 2...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/Email reçu - Accusé de réception ~ M.E.E. [24~06354] 26~06~2025 ~NDC~ Notification de conclusions (2).html"
              data-pdf="pdf/Email reçu - Accusé de réception ~ M.E.E. [24~06354] 26~06~2025 ~NDC~ Notification de conclusions (2).pdf"
              data-index="60"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">Email reçu - Accusé de réception ~ M.E.E. [24~0635...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/Email reçu - Accusé de réception ~ M.E.E. [24~06354] 26~06~2025 ~NDC~ Notification de conclusions (2) - Copie.html"
              data-pdf="pdf/Email reçu - Accusé de réception ~ M.E.E. [24~06354] 26~06~2025 ~NDC~ Notification de conclusions (2) - Copie.pdf"
              data-index="61"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">Email reçu - Accusé de réception ~ M.E.E. [24~0635...</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">12/06/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/test-conversion-body.html"
              data-pdf="pdf/test-conversion-body.pdf"
              data-index="62"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">test-conversion-body</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">26/05/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/test-sans-pieces-jointes.html"
              data-pdf="pdf/test-sans-pieces-jointes.pdf"
              data-index="63"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">test-sans-pieces-jointes</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">26/05/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/test-avec-pieces-jointes.html"
              data-pdf="pdf/test-avec-pieces-jointes.pdf"
              data-index="64"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">test-avec-pieces-jointes</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">26/05/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/test-without-attachments.html"
              data-pdf="pdf/test-without-attachments.pdf"
              data-index="65"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">test-without-attachments</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">26/05/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/test-with-attachments.html"
              data-pdf="pdf/test-with-attachments.pdf"
              data-index="66"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">test-with-attachments</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">26/05/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/test-real-structure.html"
              data-pdf="pdf/test-real-structure.pdf"
              data-index="67"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">test-real-structure</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">24/05/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>

            <div
              class="email-item"
              data-file="Output/test-email.html"
              data-pdf="pdf/test-email.pdf"
              data-index="68"
            >
              <input type="checkbox" class="email-select" />
              <div class="email-icon">
                <i class="fas fa-envelope"></i>
              </div>
              <div class="email-info">
                <div class="email-title">test-email</div>
                <div class="email-meta">
                  <span class="file-size">~5KB</span>
                  <span class="file-date">24/05/2025</span>
                </div>
              </div>
              <div class="email-actions">
                <i class="fas fa-file-pdf open-pdf" title="Ouvrir le PDF"></i>
                <i class="fas fa-paper-plane send-mail" title="Envoyer par email"></i>
                <i
                  class="fas fa-external-link-alt open-html"
                  title="Ouvrir dans un nouvel onglet"
                ></i>
              </div>
            </div>
          </div>
        </aside>

        <!-- Content Area -->
        <main class="content-area">
          <div class="welcome-screen" id="welcomeScreen">
            <div class="welcome-content">
              <i class="fas fa-envelope-open welcome-icon"></i>
              <h2>Bienvenue dans OptimXmlPreview</h2>
              <p>Sélectionnez un email dans la liste de gauche pour l'afficher</p>
              <div class="stats">
                <div class="stat-item">
                  <i class="fas fa-file-alt"></i>
                  <span>69 emails convertis</span>
                </div>
                <div class="stat-item">
                  <i class="fas fa-clock"></i>
                  <span>Dernière conversion : 12/06/2025</span>
                </div>

                <div class="stat-item">
                  <i class="fas fa-plus-circle"></i>
                  <span>1 nouveaux fichiers</span>
                </div>
              </div>
            </div>
          </div>
          <iframe id="contentFrame" src="" style="display: none"></iframe>
        </main>
      </div>
      <div class="resizer" id="sidebarResizer"></div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal-overlay" style="display: none">
      <div class="modal">
        <h3>Paramètres d'email</h3>
        <label>Objet&nbsp;:</label>
        <textarea id="subjectTemplateInput"></textarea>
        <label>Corps&nbsp;:</label>
        <div id="bodyQuill" class="quill-editor" style="height: 360px"></div>
        <div class="token-list">
          <span class="token" draggable="true">{{fileName}}</span>
          <span class="token" draggable="true">{{fileList}}</span>
          <span class="token" draggable="true">{{Role}}</span>
        </div>
        <div class="actions">
          <button class="close-btn" id="closeSettings">Annuler</button>
          <button class="save-btn" id="saveSettings">Enregistrer</button>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/quill@1.3.7/dist/quill.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Supprimer les erreurs d'extensions de navigateur de la console
        window.addEventListener('error', function (e) {
          if (e.message && e.message.includes('runtime.lastError')) {
            e.preventDefault();
            return true;
          }
        });

        const emailItems = document.querySelectorAll('.email-item');
        const contentFrame = document.getElementById('contentFrame');
        const welcomeScreen = document.getElementById('welcomeScreen');
        const searchInput = document.getElementById('searchInput');
        const convertButton = document.getElementById('convertButton');

        // Détection du contexte (serveur vs fichier local)
        const isServerMode =
          window.location.protocol === 'http:' || window.location.protocol === 'https:';
        const isFileMode = window.location.protocol === 'file:';

        // Mode détecté silencieusement
        // En mode développement, décommenter la ligne suivante :
        // console.log('OptimXmlPreview - Mode détecté:', isServerMode ? 'Serveur' : 'Fichier local');

        if (isFileMode) {
          // Désactiver le bouton de conversion en mode fichier
          if (convertButton) {
            convertButton.disabled = true;
            convertButton.innerHTML = '<i class="fas fa-info-circle"></i> Serveur requis';
            convertButton.title =
              'Démarrez le serveur (start_server.bat) pour utiliser cette fonctionnalité';
          }

          // Modifier le placeholder de recherche
          if (searchInput) {
            searchInput.placeholder = 'Recherche simple par titre...';
            searchInput.title =
              'Recherche limitée en mode fichier local. Utilisez le serveur pour la recherche complète.';
          }
        }

        // Gestion du bouton de conversion
        convertButton.addEventListener('click', function () {
          const button = this;
          const originalContent = button.innerHTML;

          // Animation de chargement
          button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Conversion...';
          button.disabled = true;

          // Appel API pour la conversion
          fetch('/api/convert', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({}),
          })
            .then((response) => response.json())
            .then((data) => {
              if (data.success) {
                // Succès
                button.innerHTML = '<i class="fas fa-check"></i> Conversion réussie !';
                showNotification(
                  'Conversion terminée ! ' + data.details.converted + ' fichier(s) converti(s)',
                  'success'
                );

                // Recharger la page après 2 secondes pour afficher les nouveaux emails
                setTimeout(() => {
                  window.location.reload();
                }, 2000);
              } else {
                // Erreur
                button.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Erreur';
                showNotification('Erreur de conversion: ' + data.error, 'error');

                // Rétablir le bouton après 3 secondes
                setTimeout(() => {
                  button.innerHTML = originalContent;
                  button.disabled = false;
                }, 3000);
              }
            })
            .catch((error) => {
              // Erreur silencieuse pour éviter le spam console
              button.innerHTML = '<i class="fas fa-exclamation-triangle"></i> Erreur réseau';
              showNotification('Erreur de connexion au serveur', 'error');

              // Rétablir le bouton après 3 secondes
              setTimeout(() => {
                button.innerHTML = originalContent;
                button.disabled = false;
              }, 3000);
            });
        });

        // Fonction pour afficher des notifications
        function showNotification(message, type = 'info') {
          const notification = document.createElement('div');
          notification.className = 'notification notification-' + type;
          notification.innerHTML =
            '<i class="fas ' +
            (type === 'success' ? 'fa-check-circle' : 'fa-info-circle') +
            '"></i><span>' +
            message +
            '</span>';

          document.body.appendChild(notification);

          // Animation d'apparition
          setTimeout(() => notification.classList.add('show'), 100);

          // Suppression automatique
          setTimeout(() => {
            notification.classList.remove('show');
            setTimeout(() => document.body.removeChild(notification), 3000);
          }, 3000);
        }

        // Navigation entre les emails
        emailItems.forEach((item) => {
          item.addEventListener('click', function () {
            const fileName = this.dataset.file;
            loadEmail(fileName, this);
          });

          // Ouvrir dans un nouvel onglet
          const externalLink = item.querySelector('.fa-external-link-alt');
          externalLink.addEventListener('click', function (e) {
            e.stopPropagation();
            const fileName = item.dataset.file;
            window.open(fileName, '_blank');
          });
        });

        // Recherche dans la liste
        let searchTimeout;
        searchInput.addEventListener('input', function () {
          const searchTerm = this.value.trim();

          // Débounce pour éviter trop de requêtes
          clearTimeout(searchTimeout);

          if (searchTerm.length === 0) {
            // Afficher tous les emails si pas de recherche
            showAllEmails();
            return;
          }

          if (searchTerm.length < 2) {
            // Attendre au moins 2 caractères
            return;
          }

          searchTimeout = setTimeout(() => {
            performFullTextSearch(searchTerm);
          }, 300);
        });

        // Fonction pour afficher tous les emails
        function showAllEmails() {
          emailItems.forEach((item) => {
            item.style.display = 'flex';
            item.classList.remove('search-highlight');
          });

          // Afficher/masquer les en-têtes de section
          document.querySelectorAll('.email-section-header').forEach((header) => {
            header.style.display = 'block';
          });
        }

        // Fonction de recherche full-text
        function performFullTextSearch(searchTerm) {
          if (isFileMode) {
            // En mode fichier local, utiliser la recherche simple par titre
            performSimpleSearch(searchTerm);
            return;
          }

          // En mode serveur, utiliser l'API de recherche
          fetch('/api/search?q=' + encodeURIComponent(searchTerm))
            .then((response) => response.json())
            .then((data) => {
              if (data.success) {
                displaySearchResults(data.results, searchTerm);
              } else {
                // Erreur de recherche gérée par notification utilisateur
                showNotification('Erreur lors de la recherche', 'error');
              }
            })
            .catch((error) => {
              // Erreur réseau gérée par notification utilisateur
              showNotification('Erreur de connexion lors de la recherche', 'error');
            });
        }

        // Fonction de recherche simple (mode fichier local)
        function performSimpleSearch(searchTerm) {
          const searchTermLower = searchTerm.toLowerCase();
          let hasResults = false;

          // Masquer les en-têtes de section
          document.querySelectorAll('.email-section-header').forEach((header) => {
            header.style.display = 'none';
          });

          emailItems.forEach((item) => {
            const title = item.querySelector('.email-title').textContent.toLowerCase();
            if (title.includes(searchTermLower)) {
              item.style.display = 'flex';
              item.classList.add('search-highlight');
              hasResults = true;
            } else {
              item.style.display = 'none';
              item.classList.remove('search-highlight');
            }
          });

          if (!hasResults) {
            showNoResultsMessage(searchTerm);
          }
        }

        // Fonction pour afficher les résultats de recherche
        function displaySearchResults(results, searchTerm) {
          // Masquer d'abord tous les emails
          emailItems.forEach((item) => {
            item.style.display = 'none';
            item.classList.remove('search-highlight');
          });

          // Masquer les en-têtes de section pendant la recherche
          document.querySelectorAll('.email-section-header').forEach((header) => {
            header.style.display = 'none';
          });

          let hasResults = false;

          results.forEach((result) => {
            // Trouver l'élément email correspondant
            const emailItem = Array.from(emailItems).find((item) => {
              const dataFile = item.dataset.file;
              const fileName = dataFile.replace('Output/', '');
              return fileName === result.file;
            });

            if (emailItem) {
              emailItem.style.display = 'flex';
              emailItem.classList.add('search-highlight');

              // Ajouter des badges de correspondance
              addMatchBadges(emailItem, result.matches);
              hasResults = true;
            }
          });

          // Afficher un message si aucun résultat
          if (!hasResults) {
            showNoResultsMessage(searchTerm);
          }
        }

        // Fonction pour ajouter des badges de correspondance
        function addMatchBadges(emailItem, matches) {
          // Supprimer les anciens badges
          const existingBadges = emailItem.querySelectorAll('.match-badge');
          existingBadges.forEach((badge) => badge.remove());

          // Ajouter les nouveaux badges
          const emailInfo = emailItem.querySelector('.email-info');
          const badgeContainer = document.createElement('div');
          badgeContainer.className = 'match-badges';

          matches.forEach((match) => {
            const badge = document.createElement('span');
            badge.className = 'match-badge';
            badge.textContent = match.type;
            badge.title = 'Trouvé dans: ' + match.type + ' - "' + match.value + '"';
            badgeContainer.appendChild(badge);
          });

          emailInfo.appendChild(badgeContainer);
        }

        // Fonction pour afficher un message "aucun résultat"
        function showNoResultsMessage(searchTerm) {
          // Créer un message temporaire
          const messageDiv = document.createElement('div');
          messageDiv.className = 'no-results-message';
          messageDiv.innerHTML =
            '<div class="no-results-content">' +
            '<i class="fas fa-search"></i>' +
            '<h3>Aucun résultat trouvé</h3>' +
            '<p>Aucun email ne correspond à votre recherche <strong>' +
            searchTerm +
            '</strong></p>' +
            '<small>La recherche porte sur les sujets, expéditeurs, destinataires, corps des messages et pièces jointes.</small>' +
            '</div>';

          // Insérer le message dans la liste des emails
          const emailList = document.getElementById('emailList');
          emailList.appendChild(messageDiv);

          // Supprimer le message après un délai
          setTimeout(() => {
            if (messageDiv.parentNode) {
              messageDiv.parentNode.removeChild(messageDiv);
            }
          }, 5000);
        }

        // Fonction pour charger un email
        function loadEmail(fileName, activeItem) {
          // Mettre à jour l'état actif
          emailItems.forEach((item) => item.classList.remove('active'));
          activeItem.classList.add('active');

          // Cacher l'écran d'accueil et afficher le contenu
          welcomeScreen.style.display = 'none';
          contentFrame.style.display = 'block';
          contentFrame.src = fileName;

          // Mettre à jour l'URL sans recharger la page
          const newUrl =
            window.location.protocol +
            '//' +
            window.location.host +
            window.location.pathname +
            '?email=' +
            encodeURIComponent(fileName);
          window.history.pushState({ email: fileName }, '', newUrl);
        }

        // Charger un email depuis l'URL
        const urlParams = new URLSearchParams(window.location.search);
        const emailParam = urlParams.get('email');
        if (emailParam) {
          const targetItem = Array.from(emailItems).find(
            (item) => item.dataset.file === emailParam
          );
          if (targetItem) {
            loadEmail(emailParam, targetItem);
            targetItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          }
        }

        // Navigation avec les flèches du clavier
        document.addEventListener('keydown', function (e) {
          const activeItem = document.querySelector('.email-item.active');
          if (!activeItem) return;

          let nextItem = null;

          if (e.key === 'ArrowDown') {
            nextItem = activeItem.nextElementSibling;
            e.preventDefault();
          } else if (e.key === 'ArrowUp') {
            nextItem = activeItem.previousElementSibling;
            e.preventDefault();
          }

          if (nextItem && nextItem.classList.contains('email-item')) {
            nextItem.click();
            nextItem.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          }
        });

        // Gestion du retour navigateur
        window.addEventListener('popstate', function (e) {
          if (e.state && e.state.email) {
            const targetItem = Array.from(emailItems).find(
              (item) => item.dataset.file === e.state.email
            );
            if (targetItem) {
              loadEmail(e.state.email, targetItem);
            }
          } else {
            // Retour à l'accueil
            emailItems.forEach((item) => item.classList.remove('active'));
            welcomeScreen.style.display = 'flex';
            contentFrame.style.display = 'none';
          }
        });

        // Interface chargée avec succès
        // En mode développement, décommenter la ligne suivante :
        // console.log('OptimXmlPreview Navigation Interface loaded successfully');

        const checkboxes = document.querySelectorAll('.email-select');
        const sendSelectedButton = document.getElementById('sendSelectedButton');

        function updateSelected() {
          const any = Array.from(checkboxes).some((cb) => cb.checked);
          sendSelectedButton.disabled = !any;
        }

        checkboxes.forEach((cb) => {
          cb.addEventListener('click', (e) => {
            e.stopPropagation();
            updateSelected();
          });
        });

        sendSelectedButton.addEventListener('click', function () {
          const files = Array.from(checkboxes)
            .filter((cb) => cb.checked)
            .map((cb) => cb.closest('.email-item').dataset.pdf);
          if (files.length === 0) return;
          fetch('/api/send-email', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ files }),
          })
            .then(() => {
              showNotification(
                'Préparation Outlook avec ' + files.length + ' pièce(s) jointe(s)',
                'success'
              );
            })
            .catch(() => {
              showNotification("Erreur lors de la préparation de l'email", 'error');
            });
        });

        // nouvelles actions PDF & mail par item
        emailItems.forEach((item) => {
          const pdfIcon = item.querySelector('.open-pdf');
          pdfIcon.addEventListener('click', function (e) {
            e.stopPropagation();
            const pdf = item.dataset.pdf;
            window.open(pdf, '_blank');
          });

          const mailIcon = item.querySelector('.send-mail');
          mailIcon.addEventListener('click', function (e) {
            e.stopPropagation();
            const pdf = item.dataset.pdf;
            fetch('/api/send-email', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ files: [pdf] }),
            })
              .then(() => {
                showNotification('Email prêt dans Outlook', 'success');
              })
              .catch(() => {
                showNotification("Erreur lors de la préparation de l'email", 'error');
              });
          });
        });

        /* ---- Drag & Drop Upload XML ---- */
        const sidebar = document.querySelector('.sidebar');
        if (sidebar && isServerMode) {
          const highlight = () => sidebar.classList.add('drop-target');
          const unHighlight = () => sidebar.classList.remove('drop-target');

          ['dragenter', 'dragover'].forEach((evt) => {
            sidebar.addEventListener(evt, (e) => {
              e.preventDefault();
              highlight();
            });
          });
          ['dragleave', 'drop'].forEach((evt) => {
            sidebar.addEventListener(evt, (e) => {
              e.preventDefault();
              unHighlight();
            });
          });

          sidebar.addEventListener('drop', (e) => {
            e.preventDefault();
            unHighlight();
            const xmlFiles = Array.from(e.dataTransfer.files).filter((f) =>
              /\.x?xml$/i.test(f.name)
            );
            if (xmlFiles.length === 0) {
              showNotification('Aucun fichier XML détecté', 'error');
              return;
            }
            const formData = new FormData();
            xmlFiles.forEach((f) => formData.append('files', f));
            showNotification('Envoi de ' + xmlFiles.length + ' fichier(s) XML...', 'info');
            fetch('/api/upload-xml', { method: 'POST', body: formData })
              .then((r) => r.json())
              .then((d) => {
                if (d.success) {
                  showNotification(
                    'Conversion terminée (' + d.converted + ' fichier(s))',
                    'success'
                  );
                  setTimeout(() => location.reload(), 2000);
                } else {
                  showNotification('Erreur: ' + (d.error || 'Conversion'), 'error');
                }
              })
              .catch(() => showNotification("Erreur réseau lors de l'upload", 'error'));
          });
        }

        /* ---------- Settings Modal Logic ---------- */
        const openSettingsBtn = document.getElementById('openSettings');
        const settingsModal = document.getElementById('settingsModal');
        const subjectInput = document.getElementById('subjectTemplateInput');
        let quill;
        const bodyQuillContainer = document.getElementById('bodyQuill');
        const closeSettingsBtn = document.getElementById('closeSettings');
        const saveSettingsBtn = document.getElementById('saveSettings');
        const tokens = settingsModal.querySelectorAll('.token');

        // Focus tracking to know where to insert tokens
        let lastTarget = 'subject';
        subjectInput.addEventListener('focus', () => {
          lastTarget = 'subject';
        });
        ensureQuill();
        quill.root.addEventListener('focus', () => {
          lastTarget = 'quill';
        });

        // tokens click handler adjustment
        tokens.forEach((t) => {
          t.addEventListener('click', () => {
            const token = t.textContent;
            if (lastTarget === 'subject') {
              insertAtCursor(subjectInput, token);
            } else {
              const range = quill.getSelection(true) || { index: quill.getLength(), length: 0 };
              quill.insertText(range.index, token);
              quill.setSelection(range.index + token.length, 0);
            }
          });
        });

        function insertAtCursor(textarea, text) {
          const start = textarea.selectionStart || 0;
          const end = textarea.selectionEnd || 0;
          textarea.value = textarea.value.slice(0, start) + text + textarea.value.slice(end);
          textarea.selectionStart = textarea.selectionEnd = start + text.length;
          textarea.focus();
        }

        openSettingsBtn.addEventListener('click', () => {
          fetch('/api/email-config')
            .then((r) => r.json())
            .then((d) => {
              if (d.success) {
                subjectInput.value = d.config.subjectTemplate || '';
                if (!quill) {
                  quill = new Quill('#bodyQuill', { theme: 'snow' });
                }
                quill.root.innerHTML = d.config.bodyTemplate || '';
              }
            })
            .catch(() => {});
          settingsModal.style.display = 'flex';
        });

        closeSettingsBtn.addEventListener('click', () => {
          settingsModal.style.display = 'none';
        });

        saveSettingsBtn.addEventListener('click', () => {
          const payload = {
            subjectTemplate: subjectInput.value,
            bodyTemplate: quill ? quill.root.innerHTML : '',
          };
          fetch('/api/email-config', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload),
          })
            .then((r) => r.json())
            .then((d) => {
              if (d.success) {
                showNotification('Paramètres enregistrés', 'success');
                settingsModal.style.display = 'none';
              } else {
                showNotification('Erreur enregistrement', 'error');
              }
            })
            .catch(() => showNotification('Erreur réseau', 'error'));
        });

        // Enable drop on Objet textarea
        subjectInput.addEventListener('dragover', (e) => {
          e.preventDefault();
        });
        subjectInput.addEventListener('drop', (e) => {
          e.preventDefault();
          const token = e.dataTransfer.getData('text/plain');
          if (token) insertAtCursor(subjectInput, token);
        });

        // Enable drop on Quill editor
        let lastQuillRange = null;
        function ensureQuill() {
          if (!quill) {
            quill = new Quill('#bodyQuill', { theme: 'snow' });
          }
        }
        ensureQuill();
        quill.on('selection-change', (range) => {
          if (range) lastQuillRange = range;
        });
        bodyQuillContainer.addEventListener('dragover', (e) => {
          e.preventDefault();
        });
        bodyQuillContainer.addEventListener('drop', (e) => {
          e.preventDefault();
          const token = e.dataTransfer.getData('text/plain');
          if (!token) return;
          const idx = lastQuillRange ? lastQuillRange.index : quill.getLength();
          quill.insertText(idx, token);
          quill.setSelection(idx + token.length, 0);
        });

        /* -------- Sidebar resizer -------- */
        const resizer = document.getElementById('sidebarResizer');
        let isResizing = false;
        resizer.addEventListener('mousedown', (e) => {
          isResizing = true;
          document.body.style.cursor = 'ew-resize';
        });
        document.addEventListener('mousemove', (e) => {
          if (!isResizing) return;
          const newWidth = e.clientX;
          if (newWidth < 240) return; // min width
          sidebar.style.width = newWidth + 'px';
        });
        document.addEventListener('mouseup', () => {
          if (isResizing) {
            isResizing = false;
            document.body.style.cursor = '';
          }
        });
      });
    </script>
  </body>
</html>
